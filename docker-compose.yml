version: '3.8'

services:
  # Redis 서비스 설정
  redis:
    image: "redis:alpine" # 미리 만들어진 공식 Redis 이미지를 사용
    ports:
      - "6379:6379" # 내 컴퓨터의 6379번 포트와 컨테이너의 6379번 포트를 연결

  # 장고 웹 서비스 설정
  web:
    build: . # 현재 폴더의 Dockerfile을 사용해서 이미지를 빌드
    command: python manage.py runserver 0.0.0.0:8000 # 컨테이너 실행 시 이 명령어를 실행
    volumes:
      - .:/app # 내 컴퓨터의 현재 폴더와 컨테이너의 /app 폴더를 동기화 (코드 수정 시 자동 반영)
    ports:
      - "8000:8000" # 내 컴퓨터의 8000번 포트와 컨테이너의 8000번 포트를 연결
    depends_on:
      - redis # web 서비스는 redis 서비스가 먼저 실행된 후에 실행